<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="products_attributes_inherit" inherit_id="website_sale.products_attributes" active="True"
              name="Attributes &amp; Variants filters">
        <xpath expr="//div[@id='wsale_products_attributes_collapse'][1]" position="replace">
            <div id="wsale_products_attributes_collapse"
                 class=" position-relative">
                <form t-if="attributes or all_tags" class="js_attributes position-relative mb-2" method="get">
                    <input t-if="category" type="hidden" name="category" t-att-value="category.id"/>
                    <input type="hidden" name="search" t-att-value="search"/>
                    <input type="hidden" name="order" t-att-value="order"/>
                    <a t-if="attrib_values or tags"
                       t-att-href="keep('/shop'+ ('/category/'+slug(category)) if category else None, attrib=0, tags=0)"
                       t-attf-class="btn btn-{{navClass}} d-flex align-items-center py-1 mb-2">
                        <small class="mx-auto">
                            <b>Clear Filters</b>
                        </small>
                        <i class="oi oi-close"/>
                    </a>
                    <t t-foreach="attributes" t-as="a">
                        <t t-cache="a,attrib_set">
                            <div class="accordion-item nav-item mb-1 border-0"
                                 t-if="a.value_ids and len(a.value_ids) &gt; 1">
                                <h6 class="mb-3">
                                    <b class="o_products_attributes_title d-none d-lg-block" t-field="a.name"/>
                                </h6>
                                <div t-attf-id="o_products_attributes_{{a.id}}" class="">
                                    <t t-if="a.display_type == 'select'">
                                        <select class="form-select css_attribute_select mb-2" name="attrib">
                                            <option value="" selected="true">-</option>
                                            <t t-foreach="a.value_ids" t-as="v">
                                                <t t-if="v in request.env['product.template'].get_active_attribute_values()">
                                                    <option t-att-value="'%s-%s' % (a.id,v.id)" t-esc="v.name"
                                                            t-att-selected="v.id in attrib_set"/>
                                                </t>
                                            </t>
                                        </select>
                                    </t>
                                    <div t-elif="a.display_type == 'color'" class="mb-3">
                                        <t t-foreach="a.value_ids" t-as="v">
                                            <t t-if="v in request.env['product.template'].get_active_attribute_values()">

                                                <t t-set="img_style"
                                                   t-value="'background:url(/web/image/product.attribute.value/%s/image); background-size:cover;' % v.id if v.image else ''"
                                                />
                                                <t t-set="color_style"
                                                   t-value="'background: ' + str(v.html_color or v.name if not v.is_custom else '')"
                                                />
                                                <label t-attf-style="#{img_style or color_style}"
                                                       t-attf-class="css_attribute_color mb-1 #{'active' if v.id in attrib_set else ''}"
                                                >
                                                    <input type="checkbox"
                                                           name="attrib"
                                                           t-att-value="'%s-%s' % (a.id, v.id)"
                                                           t-att-checked="'checked' if v.id in attrib_set else None"
                                                           t-att-title="v.name"
                                                    />
                                                </label>
                                            </t>
                                        </t>
                                    </div>
                                    <div t-elif="a.display_type in ('radio', 'pills', 'multi')"
                                         class="flex-column mb-3">
                                        <t t-foreach="a.value_ids" t-as="v">
                                            <t t-if="v in request.env['product.template'].get_active_attribute_values()">
                                                <div class="form-check mb-1">
                                                    <input type="checkbox"
                                                           name="attrib"
                                                           class="form-check-input"
                                                           t-att-id="'%s-%s' % (a.id,v.id)"
                                                           t-att-value="'%s-%s' % (a.id,v.id)"
                                                           t-att-checked="'checked' if v.id in attrib_set else None"/>
                                                    <label class="form-check-label fw-normal"
                                                           t-att-for="'%s-%s' % (a.id,v.id)" t-field="v.name"/>
                                                </div>
                                            </t>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </t>
                    <t t-if="opt_wsale_filter_tags and opt_wsale_attributes"
                       t-call="website_sale.filter_products_tags"
                    >
                        <t t-set="all_tags" t-value="all_tags"/>
                    </t>
                </form>
            </div>
        </xpath>
    </template>

</odoo>
